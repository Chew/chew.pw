<% content_for :meta_tags do %>
  <%= meta_tags title: "MLB Stats",
                description: "Major league stats for major league baseball!",
                service: "Chew's MLB Stats",
                keywords: "sports mlb baseball" %>
<% end %>

<h1>Chew's MLB Stats</h1>

<p>
  With this site, you can view information in unique ways. On a team page, you can see a team's 500 chart.
  Viewing a game shows a lot of information about the game, even some stuff Gameday doesn't show!
</p>

<h2>Table of Contents</h2>
<ul>
  <li><%= link_to "Today's Schedule", "#schedule" %></li>
  <li><%= link_to "Team Standings", "#standings" %></li>
</ul>

<h2 id="schedule">Today's Schedule</h2>
<p>Games today: <%= @schedule['totalGames'] %> (<%= @schedule['totalGamesInProgress'] %> in-progress)</p>

<div class="row">
  <% @schedule['dates'][0]['games'].each do |game| %>
    <div class="col-md-6">
      <div class="card">
        <div class="card-body">
          <h2 class="card-title"><%= game['teams']['away']['team']['clubName'] %> @ <%= game['teams']['home']['team']['clubName'] %></h2>
          <% if %w[Postponed Scheduled Pre-Game].include? game['status']['detailedState'] %>
            <p>Game State: <%= game_status game %></p>
          <% else %>
            <p><%= link_to "Game State: #{game_status game}", "/sports/mlb/game/#{game['gamePk']}" %></p>
          <% end %>
          <% if ['Final', 'Completed Early', 'Game Over', 'In Progress'].include? game['status']['detailedState'] %>
            <%= render partial: 'scorecard', locals: { game: game['linescore'], home: game['teams']['home']['team'], away: game['teams']['away']['team'], state: game_status(game) } %>
          <% end %>
        </div>
      </div>
    </div>
  <% end %>
</div>

<hr>

<h2 id="standings">Team Standings</h2>

<div class="table-responsive">
<table class="table table-striped table-bordered table-hover" data-toggle="table" data-search="true">
  <thead class="table-dark">
  <tr>
    <th data-sortable="true" data-field="team" data-switchable="false" data-sort-order="asc">Team</th>
    <th data-sortable="true" data-field="wins" data-switchable="false" data-sort-order="desc">Wins</th>
    <th data-sortable="true" data-field="loss" data-switchable="false" data-sort-order="desc">Losses</th>
    <th data-sortable="true" data-field="ratio" data-switchable="false" data-sort-order="desc">Ratio</th>
  </tr>
  </thead>
  <tbody>
  <% @info.each do |division| %>
    <% division['teamRecords'].each do |team| %>
    <tr>
      <td><%= link_to team['team']['name'], "/sports/mlb/team/#{team['team']['id']}" %></td>
      <td><%= team['wins'] %></td>
      <td><%= team['losses'] %></td>
      <td><%= team['winningPercentage'] %></td>
    </tr>
    <% end %>
  <% end %>
  </tbody>
</table>
</div>